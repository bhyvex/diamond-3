{% extends "skeleton.j2" %}

{% block title %}
  {% if search.executed %}
    {% if search.fulltext %}
      Full text search for "{{ search.query }}"
    {% else %}
      Title search for "{{ search.query }}"
    {% endif %}
  {% else %}
    Search
  {% endif %}
{% endblock %}

{% block body %}
  <form>
    <fieldset>
      <legend class="sr">Search through the wiki</legend>

      <div class="col-7 col-9-m no-padding">
        <label class="sr" for="field-query">Query term</label>
        <input type="text" id="field-query" name="query"
          value="{{ search.query }}" class="field">

        <label>
          <input type="checkbox" name="fulltext" value="yes"
            {{ 'checked="checked"' if search.fulltext else '' }}>
            Perform a full text search
        </label>
      </div>

      <div class="col-5 col-3-m no-padding">
        <input type="submit" value="Go" class="button button-fw" />
      </div>
    </fieldset>
  </form>

  {% if search.executed %}
    <ul>
      {% for (count, name) in search.results %}
        <li>
          <a href="{{ name }}">{{ name | title }}</a>
          {% if search.fulltext %}
            . . . . {{ count | pluralize('%d match', '%d matches') }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>

    <p>{{ search.hits | pluralize('%d hit', '%d hits') }} out of
      {{ search.total | pluralize('%d page', '%d pages')}} searched.</p>
  {% endif %}
{% endblock %}
